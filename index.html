<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surprise</title>

  <style>
    :root{
      --bg1:#fff7f7;
      --bg2:#ffecec;
      --card: rgba(255,255,255,.92);
      --stroke: rgba(180,0,0,.28);
      --text: rgba(120,0,0,.95);
      --muted: rgba(140,0,0,.65);
      --glow: rgba(200,0,0,.35);
      --star: rgba(200,0,0,.28);
      --star-strong: rgba(200,0,0,.55);
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      min-height:100svh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background: linear-gradient(160deg, var(--bg1), var(--bg2));
      display:grid;
      place-items:center;
      padding:24px;
      overflow:hidden;
    }

    /* ===== √âTOILES ROUGES PARTOUT (fond) ===== */
    body::before{
      content:"";
      position:fixed;
      inset:-20%;
      pointer-events:none;
      opacity:1;
      background-image:
        /* petit pattern d‚Äô√©toiles en SVG (r√©p√©t√©) */
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cg fill='none'%3E%3Ctext x='8' y='34' font-size='18'%3E%E2%AD%90%3C/text%3E%3Ctext x='70' y='68' font-size='14'%3E%E2%AD%90%3C/text%3E%3Ctext x='30' y='110' font-size='16'%3E%E2%AD%90%3C/text%3E%3Ctext x='104' y='28' font-size='12'%3E%E2%AD%90%3C/text%3E%3C/g%3E%3C/svg%3E");
      background-size: 140px 140px;
      filter: saturate(1.2);
      mix-blend-mode: multiply;
      transform: rotate(-8deg);
    }

    /* petites √©tincelles/points rouges */
    body::after{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(2px 2px at 10% 20%, var(--star) 55%, transparent 60%),
        radial-gradient(2px 2px at 30% 70%, var(--star) 55%, transparent 60%),
        radial-gradient(2px 2px at 55% 35%, var(--star) 55%, transparent 60%),
        radial-gradient(2px 2px at 78% 62%, var(--star) 55%, transparent 60%),
        radial-gradient(2px 2px at 88% 18%, var(--star) 55%, transparent 60%);
      opacity:.55;
    }

    .wrap{ width:min(760px,100%); }

    .card{
      position:relative;
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:24px;
      padding:28px 22px;
      box-shadow:0 12px 34px rgba(120,0,0,.12);
      overflow:hidden;
    }

    /* √©toiles rouges DANS la carte aussi */
    .card::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:.35;
      background:
        radial-gradient(120px 120px at 15% 25%, rgba(200,0,0,.10), transparent 60%),
        radial-gradient(180px 180px at 85% 20%, rgba(200,0,0,.10), transparent 60%),
        radial-gradient(220px 220px at 45% 90%, rgba(200,0,0,.08), transparent 60%);
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.72);
      color:var(--muted);
      font-size:14px;
      position:relative;
      z-index:1;
    }

    .dot{
      width:8px;height:8px;border-radius:999px;
      background:var(--star-strong);
      box-shadow:0 0 14px var(--glow);
    }

    h1{
      margin:18px 0 10px;
      font-size:clamp(28px,4vw,44px);
      line-height:1.1;
      color:var(--text);
      position:relative;
      z-index:1;
    }

    p{
      margin:0;
      font-size:clamp(15px,2.2vw,18px);
      line-height:1.6;
      color:var(--muted);
      position:relative;
      z-index:1;
    }

    /* TITRE CACH√â AU D√âBUT */
    .hidden{
      opacity:0;
      transform:translateY(-10px);
      transition: opacity .6s ease, transform .6s ease;
    }
    .hidden.show{
      opacity:1;
      transform:translateY(0);
    }

    /* Zone du bouton : on la rend "relative" pour d√©placer le bouton dedans */
    .actions{
      margin-top:18px;
      position:relative;
      height:62px; /* espace pour que le bouton puisse bouger */
      border-radius:16px;
      border:1px dashed rgba(180,0,0,.18);
      background:rgba(255,255,255,.55);
      overflow:hidden;
      display:block;
      z-index:1;
    }

    .hint{
      position:absolute;
      left:14px;
      top:50%;
      transform:translateY(-50%);
      font-size:13px;
      color:rgba(120,0,0,.55);
      user-select:none;
      pointer-events:none;
    }

    /* Le bouton ‚Äúfuyant‚Äù */
    button#btn{
      position:absolute;
      left: 56%;
      top: 50%;
      transform: translate(-50%, -50%);
      cursor:pointer;
      border:none;
      padding:12px 18px;
      border-radius:14px;
      font-size:16px;
      font-weight:700;
      background:var(--text);
      color:white;
      box-shadow:0 10px 22px rgba(120,0,0,.28);
      transition: transform .12s ease, filter .12s ease, left .18s ease, top .18s ease;
      touch-action: manipulation;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }

    button#btn:hover{ filter:brightness(1.05); }
    button#btn:active{ transform: translate(-50%, -50%) scale(.99); }

    button#btn.caught{
      left: 50% !important;
      top: 50% !important;
      transition: left .25s ease, top .25s ease, filter .12s ease, transform .12s ease;
    }

    button#btn:disabled{
      opacity:.78;
      cursor:default;
    }

    .reveal{
      margin-top:18px;
      padding:18px 16px;
      border-radius:18px;
      border:1px dashed var(--stroke);
      background:rgba(255,255,255,.78);
      max-height:0;
      overflow:hidden;
      opacity:0;
      transform:translateY(8px);
      transition:.55s ease;
      position:relative;
      z-index:1;
    }

    .reveal.show{
      max-height:520px;
      opacity:1;
      transform:translateY(0);
    }

    .msg{
      font-size:clamp(16px,2.2vw,19px);
      white-space:pre-line;
      color:var(--text);
    }

    .sig{
      margin-top:12px;
      font-size:14px;
      color:var(--muted);
    }

    canvas{
      position:fixed;
      inset:0;
      pointer-events:none;
    }
  </style>
</head>

<body>
  <canvas id="confetti"></canvas>

  <main class="wrap">
    <section class="card">
      <div class="badge"><span class="dot"></span> Petit jeu avant la surprise ‚≠ê</div>

      <!-- Titre cach√© au d√©but -->
      <h1 id="title" class="hidden">‚≠ê Joyeux anniversaire Jawhour ! ü§ç‚ú®</h1>

      <p>
        Il y a un bouton‚Ä¶ mais il est un peu timide üòÑ<br/>
        Attrape-le pour ouvrir le message.
      </p>

      <div class="actions" id="arena" aria-label="Zone du bouton">
        <span class="hint" id="hint">Essaie de cliquer üòÖ</span>
        <button id="btn" type="button">Ouvrir üéÅ</button>
      </div>

      <div id="reveal" class="reveal" aria-live="polite">
        <div class="msg" id="msg"></div>
        <div class="sig">‚Äî De la part de quelqu‚Äôun qui te souhaite le meilleur.</div>
      </div>
    </section>
  </main>

  <script>
    /* ===== MESSAGE (comme tu l‚Äôas demand√©) ===== */
    const MESSAGE = `Joyeux anniversaire Jawhour !
Je te souhaite tout le bonheur du monde.
CTT`;

    const btn = document.getElementById("btn");
    const arena = document.getElementById("arena");
    const hint = document.getElementById("hint");
    const title = document.getElementById("title");
    const reveal = document.getElementById("reveal");
    const msg = document.getElementById("msg");

    // ===== Confettis rouges/blancs (l√©ger) =====
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    let particles = [];
    function resize(){
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    function confetti(){
      const colors = ["rgba(180,0,0,.85)", "rgba(255,255,255,.95)"];
      particles = Array.from({length: 140}, () => ({
        x: window.innerWidth * (0.35 + Math.random()*0.3),
        y: window.innerHeight * (0.15 + Math.random()*0.15),
        vx: (Math.random()-0.5)*7,
        vy: (Math.random()-1.2)*8,
        g: 0.24 + Math.random()*0.08,
        a: 1,
        r: 3 + Math.random()*3,
        c: colors[Math.random() < 0.65 ? 0 : 1]
      }));
      animate();
    }

    function animate(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      particles.forEach(p => {
        p.vy += p.g;
        p.x += p.vx;
        p.y += p.vy;
        p.a *= 0.985;

        ctx.globalAlpha = p.a;
        ctx.fillStyle = p.c;
        ctx.fillRect(p.x, p.y, p.r*1.2, p.r);
      });
      particles = particles.filter(p => p.a > 0.05 && p.y < window.innerHeight + 40);
      if (particles.length) requestAnimationFrame(animate);
    }

    // ===== Bouton qui s‚Äô√©chappe =====
    let moves = 0;
    const MAX_MOVES = 7;       // apr√®s X esquives, il se laisse attraper
    const LOCK_AFTER_MS = 9000; // ou apr√®s 9 sec, on le rend prenable

    let canDodge = true;

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function moveButtonAway(pointerX, pointerY){
      if (!canDodge) return;

      const rect = arena.getBoundingClientRect();
      const btnRect = btn.getBoundingClientRect();

      // marges pour que le bouton reste dans la zone
      const pad = 10;
      const w = btnRect.width;
      const h = btnRect.height;

      // Choisir une nouvelle position "loin" du pointeur
      // On part sur une position al√©atoire, puis on la pousse √† l'oppos√© du pointeur
      let x = Math.random() * (rect.width - w - pad*2) + pad;
      let y = Math.random() * (rect.height - h - pad*2) + pad;

      // pousser √† l'oppos√© du pointeur (effet fuite)
      const px = pointerX - rect.left;
      const py = pointerY - rect.top;
      const dx = (x + w/2) - px;
      const dy = (y + h/2) - py;

      x = x + Math.sign(dx) * 24;
      y = y + Math.sign(dy) * 14;

      x = clamp(x, pad, rect.width - w - pad);
      y = clamp(y, pad, rect.height - h - pad);

      // appliquer (left/top attendent des % ? Non, ici px dans un conteneur relatif)
      btn.style.left = (x + w/2) + "px";
      btn.style.top  = (y + h/2) + "px";

      moves++;

      if (moves === 2) hint.textContent = "Encore un effort üòÑ";
      if (moves === 4) hint.textContent = "Il commence √† se fatiguer‚Ä¶";
      if (moves >= MAX_MOVES){
        canDodge = false;
        hint.textContent = "OK‚Ä¶ tu as gagn√© üòÖ";
        btn.classList.add("caught");
        btn.style.left = "50%";
        btn.style.top = "50%";
      }
    }

    // D√©clenchement esquive (desktop: souris, mobile: doigt)
    btn.addEventListener("mouseenter", (e) => {
      // placer avec la souris
      moveButtonAway(e.clientX, e.clientY);
    });

    btn.addEventListener("mousemove", (e) => {
      // un peu plus taquin
      if (canDodge && moves < MAX_MOVES) moveButtonAway(e.clientX, e.clientY);
    });

    btn.addEventListener("touchstart", (e) => {
      const t = e.touches && e.touches[0];
      if (!t) return;
      // Emp√™che le "click" imm√©diat sur mobile quand il esquive
      if (canDodge) e.preventDefault();
      moveButtonAway(t.clientX, t.clientY);
    }, {passive:false});

    // S√©curit√©: apr√®s un petit moment, on arr√™te de troller
    setTimeout(() => {
      if (!canDodge) return;
      canDodge = false;
      hint.textContent = "Allez‚Ä¶ clique maintenant ü§ç";
      btn.classList.add("caught");
      btn.style.left = "50%";
      btn.style.top  = "50%";
    }, LOCK_AFTER_MS);

    // ===== Au clic : afficher titre + message =====
    btn.addEventListener("click", () => {
      // si encore en mode esquive, on ignore le clic
      if (canDodge) return;

      btn.disabled = true;
      btn.textContent = "Ouvert ‚≠ê";

      // Afficher le titre
      title.classList.add("show");

      // Afficher le message
      msg.textContent = MESSAGE;
      reveal.classList.add("show");

      // Confettis
      confetti();
    });
  </script>
</body>
</html>
